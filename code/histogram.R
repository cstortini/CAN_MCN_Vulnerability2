#making a histogram of the vulnerability data
library(dplyr)

#start by chopping the vulnerability data from RCP 2.6 and removing unnecessary columns

pathdir_26 <- "data/climate_vulnerability_26.csv"

vul_df2.6 <- rbind(read.csv(pathdir_26)) %>%
  dplyr :: select(-adcap, -sens, -expo, -adcapsd, -senssd, -exposd, -tl, -nspecies)


typeof(vul_df2.6)
#vul_df is a list and needs to be numeric

unlist(vul_df2.6)

lapply(vul_df2.6, as.numeric) # now that the data are unlisted I try to convert to numeric

is.numeric(vul_df2.6) #still false...

#converting all columns to numeric individually?
vul_df2.6$rcp <- lapply(vul_df2.6$rcp, as.numeric)
vul_df2.6$lon <- lapply(vul_df2.6$lon, as.numeric)
vul_df2.6$lat <- lapply(vul_df2.6$lat, as.numeric)
vul_df2.6$vuln <- lapply(vul_df2.6$vuln, as.numeric)
vul_df2.6$vulnsd <- lapply(vul_df2.6$vulnsd, as.numeric)


#taking a different approach and trying to cut down/ group the data to make sense of it
a <- vul_df2.6%>%
  dplyr::filter(lat == "41.375")
b <- vul_df2.6%>%
  dplyr::filter(lat == "77.875")
c <- vul_df2.6%>%
  dplyr::filter(lat == "77.625")
d <- vul_df2.6%>%
  dplyr::filter(lat == "77.375")
e <- vul_df2.6%>%
  dplyr::filter(lat == "41.125")
#mean at single latitude points
mean(vul_df2.6[vul_df2.6$lat == "41.375", "vuln"])
mean(vul_df2.6[vul_df2.6$lat == "77.875", "vuln"])
mean(vul_df2.6[vul_df2.6$lat == "77.625", "vuln"])
mean(vul_df2.6[vul_df2.6$lat == "77.375", "vuln"])
mean(vul_df2.6[vul_df2.6$lat == "41.125", "vuln"])

#nevermind the below commands do what i tried above but way more efficiently
str(vul_df2.6) # see how the data looks
vul_df2.6 %>% group_by(lat)%>%str # sub-grouping it

vuln_bylat <- vul_df2.6%>% #making a summary table
  group_by(lat)%>%
  summarise(mean_vulnbylat = mean(vuln))

vuln_bylat #view that summary table