
#load in libraries
library(dplyr)
library(ggplot2)
library(patchwork)

#histogram of oceans plotted over each other
#overall
ggplot(rcp_26, aes(x = vuln, fill = rcp)) + 
  geom_histogram()+
  theme(legend.position = "none")
ggplot(rcp_85, aes(x = vuln, fill = rcp)) + 
  geom_histogram()+ 
  theme(legend.position = "none")
#by ocean
ggplot(rcp_26, aes(x = vuln, fill = ocean)) + 
  geom_histogram()
ggplot(rcp_85, aes(x = vuln, fill = ocean)) + 
  geom_histogram()
#by region
ggplot(rcp_26, aes(x = vuln, fill = region)) + 
  geom_histogram(alpha = 0.4)+
  theme(legend.position = "bottom")
ggplot(rcp_85, aes(x = vuln, fill = region)) + 
  geom_histogram()+
  theme(legend.position = "bottom")
#making sure no values are blocked
ggplot(rcp_26, aes(x = vuln, colour = region)) + 
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")
ggplot(rcp_85, aes(x = vuln, colour = region)) + 
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")

#by MPA
ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = vuln, fill = name))+
  geom_histogram(alpha = 0.4, position = 'identity')+
  theme(legend.position = "bottom")
ggplot(rcp_85 %>% dplyr::filter( type == "MPA"), aes(x = vuln, fill = name))+
    geom_histogram(alpha = 0.4, position = 'identity')+
    theme(legend.position = "bottom")
#making sure no values are blocked
ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = vuln, colour = name))+
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")
ggplot(rcp_85 %>% dplyr::filter( type == "MPA"), aes(x = vuln, colour = name))+
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")

#fixing regions so greatest values are in the back
aa <- arrange(rcp_26, region)
bb <- factor()

ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = vuln, fill = name))+
  geom_freqpoly()

ggplot(aa, aes(x = vuln, fill = region)) + 
  geom_histogram()

ggplot(aa %>% dplyr::filter( type == "MPA"), aes(x = vuln, fill = name))+
  geom_histogram(color='#e9ecef', alpha=0.6, position='identity')+
  theme(legend.position = "bottom")

#histograms with density curves on the same graph
ggplot(rcp_26, aes(x = vuln)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "white") +
  geom_density(lwd = 1, colour = 2,
               fill = 2, alpha = 0.25)
ggplot(rcp_85, aes(x = vuln)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "white") +
  geom_density(lwd = 1, colour = 7,
               fill = 7, alpha = 0.25)