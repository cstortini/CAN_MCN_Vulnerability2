
#load in libraries
library(dplyr)
library(ggplot2)
library(patchwork)

#overall
ggplot(rcp_26, aes(x = vuln, fill = rcp)) + 
  geom_histogram()+
  theme(legend.position = "none")
ggplot(rcp_85, aes(x = vuln, fill = rcp)) + 
  geom_histogram()+ 
  theme(legend.position = "none")
#by ocean
ggplot(rcp_26, aes(x = vuln, fill = ocean)) + 
  geom_histogram()
ggplot(rcp_85, aes(x = vuln, fill = ocean)) + 
  geom_histogram()
#by region
ggplot(rcp_26, aes(x = vuln, fill = region)) + 
  geom_histogram(alpha = 0.4)+
  theme(legend.position = "bottom")
ggplot(rcp_85, aes(x = vuln, fill = region)) + 
  geom_histogram()+
  theme(legend.position = "bottom")
#making sure no values are blocked
ggplot(rcp_26, aes(x = vuln, colour = region)) + 
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")
ggplot(rcp_85, aes(x = vuln, colour = region)) + 
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")

#by MPA
ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = vuln, fill = name))+
  geom_histogram(alpha = 0.4, position = 'identity')+
  theme(legend.position = "bottom")
ggplot(rcp_85 %>% dplyr::filter( type == "MPA"), aes(x = vuln, fill = name))+
    geom_histogram(alpha = 0.4, position = 'identity')+
    theme(legend.position = "bottom")
#making sure no values are blocked
ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = vuln, colour = name))+
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")
ggplot(rcp_85 %>% dplyr::filter( type == "MPA"), aes(x = vuln, colour = name))+
  geom_freqpoly(binwidth = 0.01)+
  theme(legend.position = "bottom")
#plotting based on density, to make MPAs plots look better but I don't think this helps
ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = vuln, after_stat(density), colour = name))+
  geom_freqpoly(binwidth = 0.02)+
  theme(legend.position = "bottom")
ggplot(rcp_85 %>% dplyr::filter( type == "MPA"), aes(x = vuln, after_stat(density), colour = name))+
  geom_freqpoly(binwidth = 0.02)+
  theme(legend.position = "bottom")

#trying to fix region/mpa plots so greatest values are in the back
#these are attempts to try and re-order the data before plotting it, but they didn't work
aa <- arrange(rcp_26, region)
ggplot(aa%>% dplyr::filter( type == "MPA"), aes(x = vuln, colour = name))+
  geom_histogram(alpha = 0.4, position = 'identity')+
  theme(legend.position = "bottom")

ggplot(rcp_26 %>% dplyr::filter( type == "MPA"), aes(x = reorder(name, ~vuln), colour = name))+
  geom_histogram(alpha = 0.4, position = 'identity')+
  theme(legend.position = "bottom")


#histograms with density curves on the same graph
ggplot(rcp_26, aes(x = vuln)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "white") +
  geom_density(lwd = 1, colour = 2,
               fill = 2, alpha = 0.25)
ggplot(rcp_85, aes(x = vuln)) + 
  geom_histogram(aes(y = ..density..),
                 colour = 1, fill = "white") +
  geom_density(lwd = 1, colour = 7,
               fill = 7, alpha = 0.25)